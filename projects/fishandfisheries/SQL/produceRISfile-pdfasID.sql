select (CASE WHEN r.risfield = 'ID' THEN 'ID' ELSE (CASE WHEN r.risfield = 'A' THEN 'TY' ELSE r.risfield END) END) || '  - ' || r.risentry || (CASE WHEN r.risfield = 'ZZID' THEN E'\n' || 'ER  -' ELSE '' END)  as riscolumn from (select assessid, risfield || ' -  ' || assessid as id from srdb.referencedoc where risfield='ID' order by assessid) as l, (select * from srdb.referencedoc where risfield is not null) as r, (SELECT min(assessid) as assessid, risentry from srdb.referencedoc where risfield = 'ID' GROUP BY risentry) as m where m.assessid=r.assessid and l.assessid=r.assessid and r.risfield != 'TY' order by l.id, r.risfield;
-- (SELECT min(assessid), risentry from srdb.referencedoc where risfield = 'ID' GROUP BY risentry)
