select (CASE WHEN r.risfield = 'ID' THEN 'ID' ELSE (CASE WHEN r.risfield = 'ZZID' THEN 'N1' ELSE (CASE WHEN r.risfield = 'A' THEN 'TY' ELSE r.risfield END) END) END) || '  - ' || r.risentry || (CASE WHEN r.risfield = 'ZZID' THEN E'\n' || 'ER  -' ELSE '' END)  as riscolumn from (select assessid, risfield || ' -  ' || assessid as id from srdb.referencedoc where risfield='ID' order by assessid) as l, (select * from srdb.referencedoc where risfield is not null) r where l.assessid=r.assessid and r.risfield != 'TY' order by l.id, r.risfield;
