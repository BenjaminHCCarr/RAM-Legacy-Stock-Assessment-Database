-- usage psql srdb -f Canada-stocks.sql -F "," -A -o Canadian-stock-list.csv
select * from (select aa.assessid, aa.recorder, s.stockid, s.stocklong, t.scientificname, min(ts.tsyear) || '-' || max(ts.tsyear) as years, a.assessorid, m.mgmt, lr.lme_name from srdb.management m, srdb.assessor a, srdb.assessment aa, srdb.stock s, srdb.taxonomy t, srdb.timeseries ts, srdb.lmerefs lr, srdb.lmetostocks lts, srdb.mostrecent mr where mr.ismostrecent = 1 and mr.assessid = aa.assessid and lr.lme_number=lts.lme_number and lts.stockid = s.stockid and lts.stocktolmerelation='primary' and ts.assessid = aa.assessid and t.tsn=s.tsn and s.stockid=aa.stockid and aa.assessorid=a.assessorid and a.mgmt=m.mgmt and a.mgmt in ('DFO','NAFO','ICCAT','TRAC','NMFS') and lts.lme_number in (2,3,7,8,9,18,-98) group by aa.assessid, aa.recorder, s.stockid, s.stocklong, t.scientificname, a.assessorid, m.mgmt, lr.lme_name order by mgmt, assessorid, scientificname) as bb where 
bb.stockid in (
-- list provided by Jeff Hutching
'HERR4VWX',
'COD5Zjm',
'HAD5Zejm',
'POLL4VWX5Zc',
'CUSK4X',
'COD4VsW',
'HAD4X5Y',
'WHAKE4VWX5',
'COD2J3KL',
'COD3Ps',
'AMPL23K',
'AMPL3Ps',
'MONK2J3KLNOPs',
'REDFISHSPP23K',
'SABLEFPCAN',
'HERRCC',
'HERRPRD',
'HERRQCI',
'HERRSOG',
'HERRWCVANI',
'PCODHS',
'PCODWCVANI',
'RSOLEHSTR',
'ESOLEHS',
'HERR4RFA',
'HERR4RSP',
'COD3Pn4RS',
'REDFISHSPP3Pn4RSTVn',
'GHAL4RST',
'SNOWCRABSGSL',
'HERR4TFA',
'HERR4TSP',
'COD4TVn',
'ALBANATL',
'YFINATL',
'BIGEYEATL',
'ATBTUNAWATL',
'SWORDNATL',
'COD3NO',
'AMPL3LNO',
'YELL3LNO',
'REDFISHSPP3LN',
'GHAL01ABCDEF',
'GHAL23KLMNO',
'ILLEXNWATLC',
'SDOGATLC',
'OPOUTNWATLC',
'PSOLENPCOAST',
'PHAKEPCOAST',
'LNOSESKAPCOAST',
'POPERCHPCOAST',
'DKROCKPCOAST',
'WROCKPCOAST',
'YTROCKNPCOAST',
'CROCKPCOAST',
'YEYEROCKPCOAST',
'SSTHORNHPCOAST',
'LSTHORNHPCOAST',
'LINGCODNPCOAST',
'STFLOUNNPCOAST',
'SARDPCOAST',
'CMACKPCOAST'
);
